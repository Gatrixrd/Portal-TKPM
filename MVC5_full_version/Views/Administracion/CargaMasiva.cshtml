@{
    ViewBag.Title = "Cargas Masivas";
}
<!--Mensajes -->
    <script src="~/Scripts/plugins/messenger/js/messenger.min.js"></script>
    <script src="~/Scripts/plugins/messenger/js/messenger-theme-future.js"></script>
   <link href='~/fonts/montserrat.css' rel='stylesheet' type='text/css'>
  <link href='~/fonts/opensans.css' rel='stylesheet' type='text/css'>
<!--Mensajes -->

<div class="pageheader">
    <h1>Carga Masiva</h1>
</div>
<section id="main-content" class="animated fadeInUp">
    <div class="row">
        <div class="col-md-12">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Cargas Masivas</h3>
                    <div class="actions pull-right">
                        <i class="fa fa-expand"></i>
                        <i class="fa fa-chevron-down"></i>
                        <i class="fa fa-times"></i>
                    </div>
                </div>
                <div class="panel-body">
                    <div class="tab-wrapper tab-left ">
                        <ul class="nav nav-tabs">
                            <li class="active">
                                <a href="#tabPro" data-toggle="tab">Proveedores</a>
                            </li>
                            @*<li>
                                <a href="#tabSoc" data-toggle="tab">Sociedades</a>
                            </li>
                            <li>
                                <a href="#tabOrden" data-toggle="tab">Ordenes de Compra</a>
                            </li>
                            <li>
                                <a href="#tabNota" data-toggle="tab">Notas de Cargo</a>
                            </li>*@
                        </ul>
                        <div class="tab-content">
                            <div class="tab-pane active" id="tabPro">
                                <div class="col-md-12">
                                    <div class="panel panel-default">
                                        <div class="panel-body">
                                            <p>
                                                La carga de proveedor(es) se ejecutará de manera masiva o individual, donde cargará usuarios y relación del proveedor con las sociedades (previamente deben estar cargadas las sociedades).
                                            </p>
                                        </div>
                                    </div>
                                </div>                                
                                <form class="form-horizontal" role="form" id="formCargaPro">
                                    @*<div class="form-group">
                                        <label for="fechaP" class="col-sm-3 control-label">Fecha</label>
                                        <div class="col-sm-6">
                                            <span for="fechaP"></span>
                                            <input type="text" class="form-control fechas" id="fechaP" name="fechaP" placeholder="Fecha (Opcional)" />
                                        </div>
                                    </div>*@
                                    <div class="form-group">
                                        <label for="numProveedor" class="col-sm-3 control-label">No. Proveedor</label>
                                        <div class="col-sm-6">
                                            <span for="numProveedor"></span>
                                            <input type="text" class="form-control" id="numProveedor" name="numProveedor" placeholder="Número de proveedor" />
                                             <input type="text" class="form-control" id="miSociedad" name="miSociedad" placeholder="Número de Sociedad prinicipal" value="0050" style="visibility:hidden"/>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="col-sm-offset-3 col-sm-7">
                                            <button type="button" class="btn btn-primary" id="btnImportarProveedores" name="btnImportarProveedores" data-toggle="tooltip" data-placement="bottom" title="Importar proveedores desde Datos Maestros en SAP"><i class="fa fa-group"></i>Importar 1 Proveedor desde SAP </button>
                                            <button type="button" class="btn btn-primary" id="btnProveedores" name="btnProveedores" data-toggle="tooltip" data-placement="bottom" title="Confirmar que el proveedor ya existe en Portal"><i class="fa fa-search"></i>Buscar Proveedor en Portal</button>
                                            <button type="button" class="btn btn-primary" id="btnTablaProv" name="btnTablaProv" data-toggle="tooltip" data-placement="bottom" title="Ver todos los ya importados desde SAP"><i class="fa fa-table"></i>Listar ya existentes</button>
                                            <button type="button" class="btn btn-danger" id="btnimportaSociedad" name="btnimportaSociedad" data-toggle="tooltip" data-placement="bottom" title="Ver tabla de datos desde SAP"><i class="fa fa-table"></i>Importar todo de la Sociedad</button>
                                            <button type="button" class="btn btn-success" id="btnDetProv" name="btnDetProv" data-toggle="modal" data-target="#modDetalles" style="display:none;"><i class="icon-magic-wand"></i>Detalles</button>
                                        </div>
                                    </div>
                                </form>

                            </div>

                            <div class="tab-pane" id="tabSoc">
                                <div class="col-md-12">
                                    <div class="panel panel-default">
                                        <div class="panel-body">
                                            <p>
                                                La carga de sociedad(es) se ejecutará de manera masiva o individual, donde cargará las sociedades a la base de datos.
                                            </p>
                                        </div>
                                    </div>
                                </div>      
                                <form class="form-horizontal" role="form" id="formCargaSoc">                                                                     
                                    <div class="form-group">
                                        <label for="txtSociedad" class="col-sm-3 control-label">No. Sociedad</label>
                                        <div class="col-sm-6">
                                            <span for="txtSociedad"></span>
                                            <input type="text" class="form-control" id="txtSociedad" name="txtSociedad" placeholder="Número de sociedad" />
                                        </div>
                                    </div>                                    
                                    <div class="form-group">
                                        <div class="col-sm-offset-3 col-sm-7">
                                            <button type="button" class="btn btn-primary" id="btnSociedades" name="btnSociedades"><i class="fa fa-bank"></i>Cargar Sociedades</button>
                                            <button type="button" class="btn btn-primary" id="btnTablaSoc" name="btnTablaSoc"><i class="fa fa-table"></i>Ver tabla</button>
                                            <button type="button" class="btn btn-primary" id="btnDetSoc" name="btnDetSoc" data-toggle="modal" data-target="#modDetalles" style="display:none;"><i class="fa icon-close"></i>Detalles</button>

                                        </div>
                                    </div>
                                </form>

                            </div>
                            <div class="tab-pane" id="tabOrden">
                                <div class="col-md-12">
                                    <div class="panel panel-default">
                                        <div class="panel-body">
                                            <p>
                                                La carga de orden(es) de compra se ejecutará de manera masiva o individual, donde cargará detalles, incrementables y recepciones relacionados.<br/>
                                                <strong>NOTA:</strong> Es importante que especifique la fecha inicial o un rango de fechas.
                                            </p>
                                        </div>
                                    </div>
                                </div>                                     
                                <form class="form-horizontal" role="form" id="formCargaOC">
                                    <div class="form-group">
                                        <label for="fecha1" class="col-sm-3 control-label">Fecha inicio</label>
                                        <div class="col-sm-6">
                                            <span for="fecha1"></span>
                                            <input type="text" class="form-control fecha1_boton" id="fecha1" name="fecha1" placeholder="Fecha inicial" />
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="fecha2" class="col-sm-3 control-label">Fecha Final</label>
                                        <div class="col-sm-6">
                                            <span for="fecha2"></span>
                                            <input type="text" class="form-control fecha2_boton" id="fecha2" name="fecha2" placeholder="Fecha final" />
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="numProveedorOC" class="col-sm-3 control-label">No. Proveedor</label>
                                        <div class="col-sm-6">
                                            <span for="numProveedorOC"></span>
                                            <input type="text" class="form-control" id="numProveedorOC" name="numProveedorOC" placeholder="Número de proveedor (Opcional)" />
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="numSociedad" class="col-sm-3 control-label">No. Sociedad</label>
                                        <div class="col-sm-6">
                                            <span for="numSociedad"></span>
                                            <input type="text" class="form-control" id="numSociedad" name="numSociedad" placeholder="Número de Sociedad (Opcional)" />
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="numOrdenCompra" class="col-sm-3 control-label">No. Orden de Compra</label>
                                        <div class="col-sm-6">
                                            <span for="numOrdenCompra"></span>
                                            <input type="text" class="form-control" id="numOrdenCompra" name="numOrdenCompra" placeholder="Número de Orden de Compra (Opcional)" />
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="ticket" class="col-sm-3 control-label">No. de ticket</label>
                                        <div class="col-sm-6">
                                            <span for="ticket"></span>
                                            <input type="text" class="form-control" id="ticket" name="ticket" placeholder="Número de ticket (Opcional)" />
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="col-sm-offset-3 col-sm-7">
                                            <button type="button" class="btn btn-primary" id="btnOC" name="btnOC" data-toggle="tooltip" data-placement="bottom" title="Importar Ordenes de compra desde SAP"><i class="fa fa-list-ul"></i>Importar Ordenes de Compra</button>
                                            <button type="button" class="btn btn-primary" id="btnTablaOC" name="btnTablaOC" data-toggle="tooltip" data-placement="bottom" title="Ver tabla de datos desde SAP"><i class="fa fa-table"></i>Ver tabla</button>
                                            <button type="button" class="btn btn-primary" id="btnDetOC" name="btnDetOC" data-toggle="modal" data-target="#modDetalles" style="display:none;" ><i class="fa icon-close"></i>Detalles</button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                            <div class="tab-pane" id="tabNota">
                                <div class="col-md-12">
                                    <div class="panel panel-default">
                                        <div class="panel-body">
                                            <p>
                                                La carga de notas de cargo se ejecutará de manera masiva o individual, donde podra ser por proveedor o por sociedad, o bien por paquete de proveedores. <br />
                                                <strong>NOTA:</strong> Es importante que especifique la fecha inicial o un rango de fechas.
                                            </p>
                                        </div>
                                    </div>
                                </div>
                                <form class="form-horizontal" role="form" id="formCargaNotas">
                                    <div class="form-group">
                                        <label for="fechaI" class="col-sm-3 control-label">Fecha inicio</label>
                                        <div class="col-sm-6">
                                            <span for="fechaI"></span>
                                            <input type="text" class="form-control fecha1_boton" id="fechaI" name="fechaI" placeholder="Fecha inicial" />
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="fechaF" class="col-sm-3 control-label">Fecha Final</label>
                                        <div class="col-sm-6">
                                            <span for="fechaF"></span>
                                            <input type="text" class="form-control fecha2_boton" id="fechaF" name="fechaF" placeholder="Fecha final" />
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="numProveedorN" class="col-sm-3 control-label">No. Proveedor</label>
                                        <div class="col-sm-6">
                                            <span for="numProveedorN"></span>
                                            <input type="text" class="form-control" id="numProveedorN" name="numProveedorN" placeholder="Número de proveedor (Opcional)" />
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="numSociedadN" class="col-sm-3 control-label">No. Sociedad</label>
                                        <div class="col-sm-6">
                                            <span for="numSociedadN"></span>
                                            <input type="text" class="form-control" id="numSociedadN" name="numSociedadN" placeholder="Número de Sociedad (Opcional)" />
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="tipoDocumentoN" class="col-sm-3 control-label">Tipo de Documento</label>
                                        <div class="col-sm-6">
                                            <span for="tipoDocumentoN"></span>
                                            <input type="text" class="form-control" id="tipoDocumentoN" name="tipoDocumentoN" placeholder="Default: YR" />
                                        </div>
                                    </div>                                    
                                    <div class="form-group">
                                        <div class="col-sm-offset-3 col-sm-7">
                                            <button type="button" class="btn btn-primary" id="btnNota" name="btnNota"><i class="fa icon-note"></i>Importar Notas de Cargo</button>
                                            <button type="button" class="btn btn-primary" id="btnTablaNota" name="btnTablaNota"><i class="fa fa-table"></i>Ver tabla</button>
                                            <button type="button" class="btn btn-primary" id="btnDetNota" name="btnDetNota" data-toggle="modal" data-target="#modDetalles" style="display:none;"><i class="fa icon-close "></i>Detalles</button>
                                        </div>
                                    </div>
                                </form>

                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row" id="Tablas" style="display:none;">
        <div class="col-md-12">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Información</h3>
                    <div class="actions pull-right">
                        <i class="fa fa-expand"></i>
                        <i class="fa fa-chevron-down"></i>
                        <i class="fa fa-times"></i>
                    </div>
                </div>
                <div class="panel-body">
                    <div class="table-responsive">                       
                        
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<div class="modal fade" id="modDetalles" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" id="btnCerrarDetalles" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="myModalLabel">Detalles</h4>
            </div>
            <div class="modal-body">
                <div class="panel-body" id="mensajes">

                </div>
            </div>
            <div class="modal-footer">
                <button type="button" id="btnCerrarDetalles2" class="btn btn-primary" data-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modMensaje" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" id="btnCerrarMensajes" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="myModalLabel">Atención</h4>
            </div>
            <div class="modal-body">
                <p id="cuerpoMensaje"></p>
            </div>
            <div class="modal-footer">
                <div class="col-sm-12">
                    <button type="button" class="btn btn-primary" id="btnAceptar" name="btnAceptar" style="display:none">Aceptar</button>
                    <button type="button" id="btnCerrar" class="btn btn-primary">Cerrar</button>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modCompletarRegistroProv" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" >
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Completar registro del Proveedor</h4>
                 <a id="NombreProveedor">Proveedor</a><a id="IdProveedor" style="visibility:hidden">-1</a>
            </div>
            <div class="modal-body">
               <div>
                         <div class="panel-body" id="contenidoEdicion">
                          <!-- ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ -->
                                  <div class="col-md-12">
                                               <div class="panel panel-default">
                                                   <div class="panel-heading">
                                                       <h3 class="panel-title">Configuración del Proveedor</h3>
                                                   </div>
                                                   <div class="panel-body" style="width:100%">
                                                       <div class="tab-wrapper tab-right ">
                                                           <ul class="nav nav-tabs">
                                                               <li class="active"><a href="#datosGenerales" data-toggle="tab">General</a>
                                                               </li>
                                                               <li><a href="#adicionales" data-toggle="tab" onclick="cargaPerfiles()">Usuarios</a>
                                                               </li>
                                                           </ul>
                                                           <div class="tab-content">
                                                               <div class="tab-pane active" id="datosGenerales">
                                                                            <form class="form-vertical" role="form" id="formEdiciondatosGenerales">
                                                                                            <div class="form-group">
                                                                                                <label for="RFC" class="col-sm-6 control-label">RFC</label><br />
                                                                                                <div class="col-sm-12">
                                                                                                    <input type="text" class="form-control" id="_RFC" name="_RFC" placeholder="RFC del proveedor en mayúsculas" />
                                                                                                </div>
                                                                                            </div>
                                                                                            <div class="form-group">
                                                                                             <br />
                                                                                                <label for="Correo" class="col-sm-6 control-label">Email coorporativo</label><br />
                                                                                                <div class="col-sm-12">
                                                                                                    <input type="text" class="form-control"  id="_Correo" name="_Correo" placeholder="Para comunicación desde Portal"/>
                                                                                                </div>
                                                                                            </div>
                                                                                            <div class="form-group">
                                                                                             <br />
                                                                                                <label for="Correo2" class="col-sm-6 control-label">Código email SAP</label><br />
                                                                                                <div class="col-sm-12">
                                                                                                    <input type="text" class="form-control" id="_Correo2" name="_Correo2" placeholder="Código asignado desde SAP"/>
                                                                                                </div>
                                                                                            </div>
                                                                                            <div class="col-sm-12">
                                                                                                    <button type="button" class="btn btn-primary" id="btnGuardarCompletarRegistroProv">Guardar</button>
                                                                                            </div>
                                                                             </form>
                                                               </div>
                                                               <div class="tab-pane" id="adicionales">

                                                              <div class="panel-body">

                                                                    <button type="button" onclick="configuraAgregarUsuario()" class="btn btn-default collapsed" data-toggle="collapse" data-target="#demo" aria-expanded="false">
                                                                       Agregar usuario
                                                                    </button>
                                                                    <button type="button" onclick="configuraEditarUsuario()" class="btn btn-default collapsed" data-toggle="collapse" data-target="#demo" aria-expanded="false">
                                                                       Editar usuario
                                                                    </button>

                                                                    <div id="demo" class="collapse" aria-expanded="false" style="height: 0px;">
                                                                        <div class="panel panel-default">
                                                                                  <div class="panel-body">
                                                                                                  <form class="form-horizontal" role="form" id="formEdicionadicionales">
                                                                                                                          <div id="listadoUsuariosxProveedor" class="form-group">
                                                                                                                           <label for="misUsuarios" class="col-sm-3 control-label">Registrados</label><br />
                                                                                                                              <select id="misUsuarios" multiple="" class="form-control" style="height:60px" onclick="doSelectionUsuarios()">
                                                                                                                                  <option>Cargando...</option>
                                                                                                                              </select>
                                                                                                                          </div>
                                                                                                                           <div class="form-group">
                                                                                                                               <!--<label for="perfilUsuario" class="col-sm-2 control-label">Perfíl</label>-->
                                                                                                                               <div class="col-sm-12">
                                                                                                                                   <input type="text" class="alert alert-warning alert-dismissable" id="perfilUsuario" name="perfilUsuario" placeholder="Perfíl no asignado" disabled="disabled" />
                                                                                                                               </div>
                                                                                                                           </div>
                                                                                                                           <div class="form-group">
                                                                                                                            <label for="btnIdUsuario" class="btn btn-default btn-xs">ID</label>
                                                                                                                               <button class="btn btn-info btn-xs" id='btnIdUsuario' type='button'>-1</button>
                                                                                                                           </div>
                                                                                                                           <div class="form-group">
                                                                                                                               <label for="nombreUsuario" class="col-sm-2 control-label">Usuario</label><br />
                                                                                                                               <div class="col-sm-12">
                                                                                                                                   <input type="text" class="form-control" id="nombreUsuario" name="nombreUsuario" placeholder="Alias o nombre del usuario" />
                                                                                                                               </div>
                                                                                                                           </div>
                                                                                                                           <div class="form-group">
                                                                                                                               <label for="passwordUsuario" class="col-sm-2 control-label">Password</label>
                                                                                                                               <div class="col-sm-12">
                                                                                                                                   <input type="text" class="form-control" id="passwordUsuario" name="passwordUsuario" placeholder="Password del usuario" />
                                                                                                                               </div>
                                                                                                                           </div>
                                                                                                                           <div class="form-group">
                                                                                                                               <label for="correoUsuario" class="col-sm-2 control-label">Email</label>
                                                                                                                               <div class="col-sm-12">
                                                                                                                                   <input type="text" class="form-control" id="correoUsuario" name="correoUsuario" placeholder="Correo personal" />
                                                                                                                               </div>
                                                                                                                           </div>
                                                                                                                           <div id="listadoTodosPerfiles"class="form-group">
                                                                                                                            <div class="btn-group open">
                                                                                                                                    <label for="btnperfilAsignado" class="col-sm-3 control-label">Perfiles</label><br />
                                                                                                                                            <select id="btnperfilAsignado" multiple="" class="form-control" style="height:60px;width:100%" onclick="doSelection()">
                                                                                                                                                <option>Cargando...</option>
                                                                                                                                            </select>
                                                                                                                           </div>
                                                                                                                            </div>
                                                                                                                           <div class="col-sm-12">
                                                                                                                                   <button type="button" class="btn btn-warning" id="btnGuardarAdicionales">Guardar</button>
                                                                                                                           </div>
                                                                                                  </form>
                                                                                  </div>
                                                                        </div>
                                                                   </div>

                                                               </div>




                                                               </div>
                                                           </div>
                                                       </div>
                                                   </div>
                                               </div>
                                  </div>
                          <!-- ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ -->
                          </div>
                </div>
            </div>
            <div class="modal-footer">
                <div class="col-sm-12">
                    <button type="button" id="btnCerrar" class="btn btn-primary" data-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>
</div>

<button id="btnMensaje" data-toggle="modal" data-target="#modMensaje" style="display:none;"></button>
@section Styles {
    @Styles.Render("~/plugins/dataTablesCSS")
 @Styles.Render("~/plugins/messengerCSS")

    <style>
    #formCargas .form-group .col-sm-6 i {
        position: absolute;
        left: 27px;
        top: 11px;
    }

    #formCargaOC #fecha1, #formCargaOC #fecha2, #formCargaPro #fechaP, #formCargaNotas #fechaI, #formCargaNotas #fechaF  {

        padding-left: 32px;
    }

    .ui-datepicker-trigger {
        position: absolute;
        left: 24px;
        top: 8px;
    }

    .ocultar {
        display: none;
    }

    .mostrar {
        display: inline-block;
    }
</style>


}


@section Scripts {
    @Scripts.Render("~/plugins/dataTables")
    @Scripts.Render("~/plugins/dataTables-bootstrap")
    @Scripts.Render("http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.5.2/underscore-min.js")
    @Scripts.Render("http://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.0/backbone-min.js")
    @Scripts.Render("~/plugins/messenger")


    <script>
    var url_dir = '@System.Configuration.ConfigurationManager.AppSettings["dirImagenTMS"].ToString()'
    var loading = url_dir + "/Images/bafar/ajax-loader-obs.gif";
    $(document).ready(function () {
        $(function () {
            var fechaI = "";
            var fechaF = "";
            var oc = ""
            $("a").click(function (e) {
                $("#Tablas").css("display", "none");
                $(".table-responsive").html("");
            });
            $("#btnTablaProv").click(function (e) {
                e.preventDefault();
                boton = "MostrarProv";
                $("#Tablas").css("display", "none");
                var numPro = $("#numProveedor").val();
                var fecha = "";//$("#fechaP").val();
                if (numPro == "") {
                    $("#btnAceptar").css("display", "inline-block");
                    $("#cuerpoMensaje").html("No ha especificado un número de proveedor para mostrar la información.</br></br> ¿Desea mostrar todos los proveedores disponibles?");
                    $("#btnMensaje").click();
                    return;
                }
                else {
                    MostrarTablaProveedores(numPro, fecha);
                }
            });
            $("#btnTablaSoc").click(function (e) {
                e.preventDefault();
                $("#Tablas").css("display", "none");
                boton = "MostrarSoc";
                $("#Tablas").css("display", "none");
                var sociedad = $("#txtSociedad").val();

                if (sociedad == "") {
                    $("#btnAceptar").css("display", "inline-block");
                    $("#cuerpoMensaje").html("No ha especificado un número de sociedad para mostrar la información.</br></br> ¿Desea mostrar todas las sociedades disponibles?");
                    $("#btnMensaje").click();
                    return;
                }
                else {
                    MostrarTablaSociedades(sociedad);
                }
            });
            $("#btnTablaOC").click(function (e) {
                e.preventDefault();
                $("#Tablas").css("display", "none");
                boton = "MostrarOC"
                var fecha1 = $("#fecha1").val();
                var fecha2 = $("#fecha2").val();
                var numProv = $("#numProveedorOC").val();
                var sociedad = $("#numSociedad").val();
                var ordenCompra = $("#numOrdenCompra").val();
                var ticket = $("#ticket").val();

                if (ordenCompra == "") {
                    if (fecha1 == "") {
                        $("#cuerpoMensaje").html("Para continuar especifique por lo menos la <strong>fecha inicial</strong> o un <strong>rango de fechas</strong>.");
                        $("#btnMensaje").click();
                        return;
                    }
                    else {
                        if (fecha2 == "") {
                            fecha2 = '@DateTime.Now.ToShortDateString()';
                            }
                            $("#btnAceptar").css("display", "inline-block");
                            $("#cuerpoMensaje").html("Al no especificar una orden de compra se tomaran todas las ordenes de compra comprendidas dentro del rango de fechas:</br></br><strong>Fecha inicial: " + fecha1 + "</br>Fecha final: " + fecha2 + "</strong></br></br> ¿Desea mostrar todas las ordenes de compra disponibles dentro del rango de fechas?");
                            $("#btnMensaje").click();
                            fechaI = fecha1;
                            fechaF = fecha2;
                            return;
                        }
                    }
                    else {
                        MostrarTablaOrdenCompra(fecha1, fecha2, numProv, sociedad, ordenCompra, ticket);
                    }
                });
            $("#btnTablaNota").click(function (e) {
                    e.preventDefault();
                    $("#Tablas").css("display", "none");
                    boton = "MostrarNota"
                    var fecha1 = $("#fechaI").val();
                    var fecha2 = $("#fechaF").val();
                    var numProv = $("#numProveedorN").val();
                    var sociedad = $("#numSociedadN").val();
                    var tipoDoc = $("#tipoDocumentoN").val();
                    var paquete = 0;
                    if (numProv == "") {
                        if (fecha1 == "") {
                            $("#cuerpoMensaje").html("Para continuar especifique por lo menos la <strong>fecha inicial</strong> o un <strong>rango de fechas</strong>.");
                            $("#btnMensaje").click();
                            return;
                        }
                        else {
                            if (fecha2 == "") {
                                fecha2 = '@DateTime.Now.ToShortDateString()';
                            }
                            $("#btnAceptar").css("display", "inline-block");
                            $("#cuerpoMensaje").html("Al no especificar un no. de proveedor se tomarán todas las notas de cargo de un paquete de proveedores comprendidas dentro del rango de fechas:</br></br><strong>Fecha inicial: " +
                                fecha1 + "</br>Fecha final: " + fecha2 + "</strong></br></br></strong>Paquete <input type='number' id='paquete' min='100' max='10000' step='100' value='800'></br></br>" +
                                "¿Desea continuar con la carga de todas las notas de cargo comprendidas dentro del rango de fechas?");
                            paquete = $("#paquete").val();
                            $("#btnMensaje").click();
                            fechaI = fecha1;
                            fechaF = fecha2;
                            return;
                        }
                    }
                    else {
                        MostrarTablaNotasCargo(fecha1, fecha2, numProv, sociedad, tipoDoc, paquete, false);
                    }
                });
            $("#btnCerrar").click(function (e) {
                    e.preventDefault();
                    $("#btnAceptar").css("display", "none");
                    $("#btnCerrarMensajes").click();
            });

            $("#btnProveedores").click(function (e) {
                    e.preventDefault();
                    $("#Tablas").css("display", "none");
                    boton = "Prov";
                    var numPro = $("#numProveedor").val();
                    var fecha = "";//$("#fechaP").val();
                    if (numPro == "") {
                        $("#btnAceptar").css("display", "inline-block");
                        $("#cuerpoMensaje").html("No ha especificado un número de proveedor para la carga.</br></br> ¿Desea cargar todos los proveedores?");
                        $("#btnMensaje").click();
                        return;
                    }
                    else {
                     CargarProveedores(numPro, fecha);

                    }
            });

            $("#btnImportarProveedores").click(function (e) {
             e.preventDefault();
             $("#Tablas").css("display", "none");
             boton = "Prov";
             var numPro = $("#numProveedor").val();
             var fecha = "";//$("#fechaP").val();
             if (numPro == "") {
              $("#btnAceptar").css("display", "inline-block");
              $("#cuerpoMensaje").html("No ha especificado un número de proveedor para la carga.</br></br> ¿Desea cargar todos los proveedores?");
              $("#btnMensaje").click();
              return;
             }
             else {
              ImportarProveedores(numPro);
             }
            });

            $("#btnSociedades").click(function (e) {
                    e.preventDefault();
                    $("#Tablas").css("display", "none");
                    boton = "Soc";
                    var sociedad = $("#txtSociedad").val();
                    if (sociedad == "") {
                        $("#btnAceptar").css("display", "inline-block");
                        $("#cuerpoMensaje").html("No ha especificado un número de sociedad para la carga.</br></br> ¿Desea cargar todos las sociedades?");
                        $("#btnMensaje").click();
                        return;
                    }
                    else {
                        CargarSociedades(sociedad);
                    }
                });
            $("#btnOC").click(function (e) {
                    e.preventDefault();
                    $("#Tablas").css("display", "none");
                    boton = "OC"
                    var fecha1 = $("#fecha1").val();
                    var fecha2 = $("#fecha2").val();
                    var numProv = $("#numProveedorOC").val();
                    var sociedad = $("#numSociedad").val();
                    var ordenCompra = $("#numOrdenCompra").val();

                    if (ordenCompra == "") {
                        if (fecha1 == "") {
                            $("#cuerpoMensaje").html("Para continuar especifique por lo menos la <strong>fecha inicial</strong> o un <strong>rango de fechas</strong>.");
                            $("#btnMensaje").click();
                            return;
                        }
                        else {
                            if (fecha2 == "") {
                                fecha2 = '@DateTime.Now.ToShortDateString()';
                        }
                        $("#btnAceptar").css("display", "inline-block");
                        $("#cuerpoMensaje").html("Al no especificar una orden de compra se tomaran todas las ordenes de compra comprendidas dentro del rango de fechas:</br></br><strong>Fecha inicial: " + fecha1 + "</br>Fecha final: " + fecha2 + "</strong></br></br> ¿Desea cargar todas las ordenes de compra dentro del rango de fechas?");
                        $("#btnMensaje").click();
                        fechaI = fecha1;
                        fechaF = fecha2;
                        return;
                    }
                }
                else {
                    CargarOrdenes(fecha1, fecha2, numProv, sociedad, ordenCompra);
                }
                });
            $("#btnNota").click(function (e) {
                e.preventDefault();
                $("#Tablas").css("display", "none");
                boton = "NotasCargo"
                var fecha1 = $("#fechaI").val();
                var fecha2 = $("#fechaF").val();
                var numProv = $("#numProveedorN").val();
                var sociedad = $("#numSociedadN").val();
                var tipoDoc = $("#tipoDocumentoN").val();
                var paquete = 0;
                if (numProv == "") {
                    if (fecha1 == "") {
                        $("#cuerpoMensaje").html("Para continuar especifique por lo menos la <strong>fecha inicial</strong> o un <strong>rango de fechas</strong>.");
                        $("#btnMensaje").click();
                        return;
                    }
                    else {
                        if (fecha2 == "") {
                            fecha2 = '@DateTime.Now.ToShortDateString()';
                        }
                        $("#btnAceptar").css("display", "inline-block");
                        $("#cuerpoMensaje").html("Al no especificar un no. de proveedor se tomarán todas las notas de cargo de un paquete de proveedores comprendidas dentro del rango de fechas:</br></br><strong>Fecha inicial: " +
                            fecha1 + "</br>Fecha final: " + fecha2 + "</strong></br></br></strong>Paquete <input type='number' id='paquete' min='100' max='10000' step='100' value='800'></br></br>" +
                            "¿Desea continuar con la carga de todas las notas de cargo comprendidas dentro del rango de fechas?");
                        paquete = $("#paquete").val();
                        $("#btnMensaje").click();
                        fechaI = fecha1;
                        fechaF = fecha2;
                        return;
                    }
                }
                else {                    
                    CargarNotasCargo(fecha1, fecha2, numProv, sociedad, tipoDoc, paquete, false);
                }
            });
            $("#btnAceptar").click(function (e) {
                e.preventDefault();
                switch (boton) {
                    case 'Prov':
                        CargarProveedores("", "");
                        break;
                    case 'OC':
                        var fecha1 = fechaI;
                        var fecha2 = fechaF;
                        var numProv = $("#numProveedorOC").val();
                        var sociedad = $("#numSociedad").val();
                        var ordenCompra = $("#numOrdenCompra").val();
                        var ticket = $("#ticket").val();
                        CargarOrdenes(fecha1, fecha2, numProv, sociedad, ordenCompra, ticket);
                        break;
                    case 'Soc':
                        CargarSociedades("");
                        break;
                    case 'NotasCargo':
                        var fecha1 = fechaI;
                        var fecha2 = fechaF;
                        var numProv = $("#numProveedorN").val();
                        var sociedad = $("#numSociedadN").val();
                        var tipoDoc = $("#tipoDocumentoN").val();
                        var paquete = $("#paquete").val();
                        CargarNotasCargo(fecha1, fecha2, numProv, sociedad, tipoDoc, paquete, true);
                        break;
                    case 'MostrarProv':
                        MostrarTablaProveedores("", "");
                        break;
                    case 'MostrarSoc':
                        MostrarTablaSociedades("");
                        break;
                    case 'MostrarOC':
                        var fecha1 = fechaI;
                        var fecha2 = fechaF;
                        var numProv = $("#numProveedorOC").val();
                        var sociedad = $("#numSociedad").val();
                        var ordenCompra = $("#numOrdenCompra").val();
                        var ticket = $("#ticket").val();
                        MostrarTablaOrdenCompra(fecha1, fecha2, numProv, sociedad, ordenCompra, ticket);
                        break;
                    case 'MostrarNota':
                        var fecha1 = fechaI;
                        var fecha2 = fechaF;
                        var numProv = $("#numProveedorN").val();
                        var sociedad = $("#numSociedadN").val();
                        var tipoDoc = $("#tipoDocumentoN").val();
                        var paquete = $("#paquete").val();
                        MostrarTablaNotasCargo(fecha1, fecha2, numProv, sociedad, tipoDoc, paquete, true);
                        break;
                    default:
                        break;
                }
                boton = "";
                $("#btnAceptar").css("display", "none");
                $("#btnCerrarMensajes").click();
            });

            $("#btnGuardarCompletarRegistroProv").click(function (e) {

             var idproveedor = $("#IdProveedor").text();
             var rfc = $("#_RFC").val()
             var correo = $("#_Correo").val()
             var correoSAP = $("#_Correo2").val()
                 completarRegistroProveedor(rfc, correo, correoSAP, idproveedor);
            });
 

            $("#btnGuardarAdicionales").click(function (e) {
             var idusuario = $("#btnIdUsuario").text();
             var nombreusuario = $("#nombreUsuario").val();
             var passwordusuario = $("#passwordUsuario").val();
             var correousuario = $("#correoUsuario").val();
             var idproveedor = $("#IdProveedor").text();
             var rfc = $("#_RFC").val();
             var idperfil = doSelection();
             var activo = true;
             //ABCUsuario(string idusuario,string usuario,string password,string idproveedor, string correo, bool activo,string idperfil)

             //Enviar Usuario
             $.ajax({
              type: "post",
              url: url_dir + '/Administracion/ABCUsuario',
              data: { 'idusuario':idusuario, 'usuario': nombreusuario,'password': passwordusuario,'idproveedor':idproveedor,'correo':correousuario,'activo':activo,'idperfil':idperfil},
              cache: false,
              success: function (listaUsuario) {
               if (listaUsuario.length > 0) {

               }
               else {
                $(".table-responsive").html("Ocurrío un problema con el usuario en vista.");
               }
              },
              error: function (error) {
               $("#cuerpoMensaje").html("Ocurrió un error guardando el Perfíl : " + error);
               $("#btnMensaje").click();
              }
             });
            });
  
            function CargarProveedores(prov, fech) {
                var boton = "#btnDetProv";
                var noLista = false;
                var mensajesFuncion;
                var _desbloquea = false;
                $("#mensajes").html("");
                $(document).ajaxStart(
                    $.blockUI({
                        message: '<h1><img src="' + loading + '" /> Espere...</h1>',
                        css: {
                            border: 'none',
                            padding: '15px',
                            backgroundColor: '#000',
                            '-webkit-border-radius': '10px',
                            '-moz-border-radius': '10px',
                            opacity: .5,
                            color: '#fff'
                        }
                    }))
                    .ajaxSend($.blockUI({
                        message: '<h1><img src="' + loading + '" /> Consultando...</h1>',
                        css: {
                            border: 'none',
                            padding: '15px',
                            backgroundColor: '#000',
                            '-webkit-border-radius': '10px',
                            '-moz-border-radius': '10px',
                            opacity: .5,
                            color: '#fff'
                        }
                    }))
                    .ajaxSuccess($.blockUI({
                        message: '<h1><img src="' + loading + '" /> Cargando información...</h1>',
                        css: {
                            border: 'none',
                            padding: '15px',
                            backgroundColor: '#000',
                            '-webkit-border-radius': '10px',
                            '-moz-border-radius': '10px',
                            opacity: .5,
                            color: '#fff'
                        }
                    }))
                    .ajaxError(function (xhr, status, p3, p4) {
                        $.blockUI({
                            message: '<h1><img src="' + loading + '" />Espere...</h1>',
                            css: {
                                border: 'none',
                                padding: '15px',
                                backgroundColor: '#000',
                                '-webkit-border-radius': '10px',
                                '-moz-border-radius': '10px',
                                opacity: .5,
                                color: '#fff'
                            }
                        });
                        setTimeout(function () {
                            $.unblockUI({
                                onUnblock: function () {
                                    $("#btnMensaje").click();
                                }
                            });
                        }, 2000);
                        return;

                    })
                    .ajaxComplete(function () {
                        if (noLista) {
                            $.blockUI({
                                message: '<h1><img src="' + loading + '" />Espere...</h1>',
                                css: {
                                    border: 'none',
                                    padding: '15px',
                                    backgroundColor: '#000',
                                    '-webkit-border-radius': '10px',
                                    '-moz-border-radius': '10px',
                                    opacity: .5,
                                    color: '#fff'
                                }
                            });
                            setTimeout(function () {
                                $.unblockUI({
                                    onUnblock: function () {
                                        $("#cuerpoMensaje").html(mensajesFuncion);
                                        $("#btnMensaje").click();
                                    }
                                });
                            }, 3000);
                        }
                        else {
                            $.blockUI({
                                message: '<h1><img src="' + loading + '" />Espere...</h1>',
                                css: {
                                    border: 'none',
                                    padding: '15px',
                                    backgroundColor: '#000',
                                    '-webkit-border-radius': '10px',
                                    '-moz-border-radius': '10px',
                                    opacity: .5,
                                    color: '#fff'
                                }
                            });
                            setTimeout(function () {
                                if (_desbloquea) {
                                    $.unblockUI({
                                        onUnblock: Desbloquear(mensajesFuncion, noLista, boton)
                                    });
                                    _desbloquea = false;
                                }
                                else {
                                    $.unblockUI
                                }
                            }, 3000);
                        }
                    })
                    .ajaxStop($.unblockUI);
                $.ajax({
                    type: "post",
                    url: url_dir + '/Administracion/Proveedores',
                    data: { 'numProveedor': prov, 'fechaInicial': fech },
                    cache: false,
                    success: function (lista) {
                        _desbloquea = true;
                        if (typeof (lista) == "string") {
                            noLista = true;
                        }
                        else {
                            noLista = false;
                        }
                        mensajesFuncion = lista;
                    },
                    error: function (xhr, status, p3, p4) {
                        var err = xhr.responseText + " Status" + xrhr.status;
                        $("#cuerpoMensaje").html("Ocurrió un error: " + err);
                    }

                });
            }
            function ImportarProveedores(prov) {
             var boton = "#btnDetProv";
             var noLista = false;
             var mensajesFuncion;
             var _desbloquea = false;
             $("#mensajes").html("");
             $(document).ajaxStart(
                 $.blockUI({
                  message: '<h1><img src="' + loading + '" /> Espere...</h1>',
                  css: {
                   border: 'none',
                   padding: '15px',
                   backgroundColor: '#000',
                   '-webkit-border-radius': '10px',
                   '-moz-border-radius': '10px',
                   opacity: .5,
                   color: '#fff'
                  }
                 }))
                 .ajaxSend($.blockUI({
                  message: '<h1><img src="' + loading + '" /> Consultando SAP...</h1>',
                  css: {
                   border: 'none',
                   padding: '15px',
                   backgroundColor: '#000',
                   '-webkit-border-radius': '10px',
                   '-moz-border-radius': '10px',
                   opacity: .5,
                   color: '#fff'
                  }
                 }))
                 .ajaxSuccess($.blockUI({
                  message: '<h1><img src="' + loading + '" /> Consultando SAP..</h1>',
                  css: {
                   border: 'none',
                   padding: '15px',
                   backgroundColor: '#000',
                   '-webkit-border-radius': '10px',
                   '-moz-border-radius': '10px',
                   opacity: .5,
                   color: '#fff'
                  }
                 }))
                 .ajaxError(function (xhr, status, p3, p4) {
                  $.blockUI({
                   message: '<h1><img src="' + loading + '" />Espere...</h1>',
                   css: {
                    border: 'none',
                    padding: '15px',
                    backgroundColor: '#000',
                    '-webkit-border-radius': '10px',
                    '-moz-border-radius': '10px',
                    opacity: .5,
                    color: '#fff'
                   }
                  });
                  setTimeout(function () {
                   $.unblockUI({
                    onUnblock: function () {
                     $("#btnMensaje").click();
                    }
                   });
                  }, 2000);
                  return;

                 })
                 .ajaxComplete(function () {
                  if (noLista) {
                   $.blockUI({
                    message: '<h1><img src="' + loading + '" />Espere...</h1>',
                    css: {
                     border: 'none',
                     padding: '15px',
                     backgroundColor: '#000',
                     '-webkit-border-radius': '10px',
                     '-moz-border-radius': '10px',
                     opacity: .5,
                     color: '#fff'
                    }
                   });
                   setTimeout(function () {
                    $.unblockUI({
                     onUnblock: function () {
                      $("#cuerpoMensaje").html(mensajesFuncion);
                      $("#btnMensaje").click();
                     }
                    });
                   }, 3000);
                  }
                  else {
                   $.blockUI({
                    message: '<h1><img src="' + loading + '" />Espere...</h1>',
                    css: {
                     border: 'none',
                     padding: '15px',
                     backgroundColor: '#000',
                     '-webkit-border-radius': '10px',
                     '-moz-border-radius': '10px',
                     opacity: .5,
                     color: '#fff'
                    }
                   });
                   setTimeout(function () {
                    if (_desbloquea) {
                     $.unblockUI({
                      onUnblock: Desbloquear(mensajesFuncion, noLista, boton)
                     });
                     _desbloquea = false;
                    }
                    else {
                     $.unblockUI
                    }
                   }, 3000);
                  }
                 })
                 .ajaxStop($.unblockUI);
             $.ajax({
              type: "post",
              url: url_dir + '/Administracion/ProveedoresdesdeSAP',
              data: { 'numProveedor': prov, 'Tipo': 1 },
              cache: false,
              success: function (lista) {
               _desbloquea = true;
               if (typeof (lista) == "string") {
                noLista = true;
               }
               else {
                noLista = false;
               }
               mensajesFuncion = lista;
              },
              error: function (xhr, status, p3, p4) {
               var err = xhr.responseText + " Status" + xrhr.status;
               $("#cuerpoMensaje").html("Ocurrió un error: " + err);
              }

             });
            }
            function CargarSociedades(sociedad) {
                var boton = "#btnDetSoc";
                var noLista = false;
                var mensajesFuncion;
                var _desbloquea = false;
                $("#mensajes").html("");
                $(document).ajaxStart(
                    $.blockUI({
                        message: '<h1><img src="' + loading + '" /> Espere...</h1>',
                        css: {
                            border: 'none',
                            padding: '15px',
                            backgroundColor: '#000',
                            '-webkit-border-radius': '10px',
                            '-moz-border-radius': '10px',
                            opacity: .5,
                            color: '#fff'
                        }
                    }))
                    .ajaxSend($.blockUI({
                        message: '<h1><img src="' + loading + '" /> Consultando...</h1>',
                        css: {
                            border: 'none',
                            padding: '15px',
                            backgroundColor: '#000',
                            '-webkit-border-radius': '10px',
                            '-moz-border-radius': '10px',
                            opacity: .5,
                            color: '#fff'
                        }
                    }))
                    .ajaxSuccess($.blockUI({
                        message: '<h1><img src="' + loading + '" /> Espere...</h1>',
                        css: {
                            border: 'none',
                            padding: '15px',
                            backgroundColor: '#000',
                            '-webkit-border-radius': '10px',
                            '-moz-border-radius': '10px',
                            opacity: .5,
                            color: '#fff'
                        }
                    }))
                    .ajaxError(function (xhr, status, p3, p4) {
                        $.blockUI({
                            message: '<h1><img src="' + loading + '" />Espere...</h1>',
                            css: {
                                border: 'none',
                                padding: '15px',
                                backgroundColor: '#000',
                                '-webkit-border-radius': '10px',
                                '-moz-border-radius': '10px',
                                opacity: .5,
                                color: '#fff'
                            }
                        });
                        setTimeout(function () {
                            $.unblockUI({
                                onUnblock: function () {
                                    $("#btnMensaje").click();
                                }
                            });
                        }, 2000);
                        return;
                    })
                    .ajaxComplete(function () {
                        if (noLista) {
                            $.blockUI({
                                message: '<h1><img src="' + loading + '" />Espere...</h1>',
                                css: {
                                    border: 'none',
                                    padding: '15px',
                                    backgroundColor: '#000',
                                    '-webkit-border-radius': '10px',
                                    '-moz-border-radius': '10px',
                                    opacity: .5,
                                    color: '#fff'
                                }
                            });
                            setTimeout(function () {
                                $.unblockUI({
                                    onUnblock: function () {
                                        $("#cuerpoMensaje").html(mensajesFuncion);
                                        $("#btnMensaje").click();
                                    }
                                });
                            }, 3000);
                        }
                        else {
                            $.blockUI({
                                message: '<h1><img src="' + loading + '" />Espere...</h1>',
                                css: {
                                    border: 'none',
                                    padding: '15px',
                                    backgroundColor: '#000',
                                    '-webkit-border-radius': '10px',
                                    '-moz-border-radius': '10px',
                                    opacity: .5,
                                    color: '#fff'
                                }
                            });
                            setTimeout(function () {
                                if (_desbloquea) {
                                    $.unblockUI({
                                        onUnblock: Desbloquear(mensajesFuncion, noLista, boton)
                                    });
                                    _desbloquea = false;
                                }
                                else {
                                    $.unblockUI
                                }
                            }, 3000);
                        }
                    })
                    .ajaxStop($.unblockUI);
                $.ajax({
                    type: "post",
                    url: url_dir + '/Administracion/Sociedades',
                    data: { 'sociedad': sociedad },
                    cache: false,
                    success: function (lista) {
                        _desbloquea = true;
                        if (typeof (lista) == "string") {
                            noLista = true;
                        }
                        else {
                            noLista = false;
                        }
                        mensajesFuncion = lista;
                    },
                    error: function (xhr, status, p3, p4) {
                        var err = xhr.responseText + " Status" + xrhr.status;
                        $("#cuerpoMensaje").html("Ocurrió un error: " + err);
                    }

                });
            }
            function CargarOrdenes(fecha1, fecha2, numProv, sociedad, ordenCompra, ticket) {
                var boton = "#btnDetOC";
                var noLista = false;
                var mensajesFuncion;
                var _desbloquea = false;
                $("#mensajes").html("");
                $(document).ajaxStart(
                    $.blockUI({
                        message: '<h1><img src="' + loading + '" /> Espere...</h1>',
                        css: {
                            border: 'none',
                            padding: '15px',
                            backgroundColor: '#000',
                            '-webkit-border-radius': '10px',
                            '-moz-border-radius': '10px',
                            opacity: .5,
                            color: '#fff'
                        }
                    }))
                    .ajaxSend($.blockUI({
                        message: '<h1><img src="' + loading + '" /> Consultando...</h1>',
                        css: {
                            border: 'none',
                            padding: '15px',
                            backgroundColor: '#000',
                            '-webkit-border-radius': '10px',
                            '-moz-border-radius': '10px',
                            opacity: .5,
                            color: '#fff'
                        }
                    }))
                    .ajaxSuccess($.blockUI({
                        message: '<h1><img src="' + loading + '" /> Espere...</h1>',
                        css: {
                            border: 'none',
                            padding: '15px',
                            backgroundColor: '#000',
                            '-webkit-border-radius': '10px',
                            '-moz-border-radius': '10px',
                            opacity: .5,
                            color: '#fff'
                        }
                    }))
                    .ajaxError(function (xhr, status, p3, p4) {
                        $.blockUI({
                            message: '<h1><img src="' + loading + '" />Espere...</h1>',
                            css: {
                                border: 'none',
                                padding: '15px',
                                backgroundColor: '#000',
                                '-webkit-border-radius': '10px',
                                '-moz-border-radius': '10px',
                                opacity: .5,
                                color: '#fff'
                            }
                        });
                        setTimeout(function () {
                            $.unblockUI({
                                onUnblock: function () {
                                    $("#btnMensaje").click();
                                }
                            });
                        }, 2000);
                        return;

                    })
                    .ajaxComplete(function () {
                        if (noLista) {
                            $.blockUI({
                                message: '<h1><img src="' + loading + '" />Espere...</h1>',
                                css: {
                                    border: 'none',
                                    padding: '15px',
                                    backgroundColor: '#000',
                                    '-webkit-border-radius': '10px',
                                    '-moz-border-radius': '10px',
                                    opacity: .5,
                                    color: '#fff'
                                }
                            });
                            setTimeout(function () {
                                $.unblockUI({
                                    onUnblock: function () {
                                        $("#cuerpoMensaje").html(mensajesFuncion);
                                        $("#btnMensaje").click();
                                    }
                                });
                            }, 3000);
                        }
                        else {
                            $.blockUI({
                                message: '<h1><img src="' + loading + '" />Cargando infomación...</h1>',
                                css: {
                                    border: 'none',
                                    padding: '15px',
                                    backgroundColor: '#000',
                                    '-webkit-border-radius': '10px',
                                    '-moz-border-radius': '10px',
                                    opacity: .5,
                                    color: '#fff'
                                }
                            });
                            setTimeout(function () {
                                if (_desbloquea) {
                                    $.unblockUI({
                                        onUnblock: Desbloquear(mensajesFuncion, noLista, boton)
                                    });
                                    _desbloquea = false;
                                }
                                else {
                                    $.unblockUI
                                }
                            }, 10000);
                        }
                    })
                    .ajaxStop($.unblockUI);
                $.ajax({
                    type: "post",
                    url: url_dir + '/Administracion/OrdenesCompra',
                    data: { 'fecha1': fecha1, 'fecha2': fecha2, 'numProveedor': numProv, 'sociedad': sociedad, 'ordenCompra': ordenCompra, 'ticket': ticket },
                    cache: false,
                    success: function (lista) {
                        _desbloquea = true;

                        if (typeof (lista) == "string") {
                            noLista = true;
                        }
                        else {
                            noLista = false;
                        }
                        mensajesFuncion = lista;
                    },
                    error: function (xhr, status, p3, p4) {
                        var err = xhr.responseText + " Status" + xrhr.status;
                        $("#cuerpoMensaje").html("Ocurrió un error: " + err);
                    }
                });
            }
            function CargarNotasCargo(fecha1, fecha2, numProv, sociedad, tipoDoc, paquete, todos) {
                var boton = "#btnDetNota";
                var noLista = false;
                var mensajesFuncion;
                var _desbloquea = false;
                $("#mensajes").html("");
                $(document).ajaxStart(
                    $.blockUI({
                        message: '<h1><img src="' + loading + '" /> Espere...</h1>',
                        css: {
                            border: 'none',
                            padding: '15px',
                            backgroundColor: '#000',
                            '-webkit-border-radius': '10px',
                            '-moz-border-radius': '10px',
                            opacity: .5,
                            color: '#fff'
                        }
                    }))
                    .ajaxSend($.blockUI({
                        message: '<h1><img src="' + loading + '" /> Consultando...</h1>',
                        css: {
                            border: 'none',
                            padding: '15px',
                            backgroundColor: '#000',
                            '-webkit-border-radius': '10px',
                            '-moz-border-radius': '10px',
                            opacity: .5,
                            color: '#fff'
                        }
                    }))
                    .ajaxSuccess($.blockUI({
                        message: '<h1><img src="' + loading + '" /> Espere...</h1>',
                        css: {
                            border: 'none',
                            padding: '15px',
                            backgroundColor: '#000',
                            '-webkit-border-radius': '10px',
                            '-moz-border-radius': '10px',
                            opacity: .5,
                            color: '#fff'
                        }
                    }))
                    .ajaxError(function (xhr, status, p3, p4) {
                        $.blockUI({
                            message: '<h1><img src="' + loading + '" />Espere...</h1>',
                            css: {
                                border: 'none',
                                padding: '15px',
                                backgroundColor: '#000',
                                '-webkit-border-radius': '10px',
                                '-moz-border-radius': '10px',
                                opacity: .5,
                                color: '#fff'
                            }
                        });
                        setTimeout(function () {
                            $.unblockUI({
                                onUnblock: function () {
                                    $("#btnMensaje").click();
                                }
                            });
                        }, 2000);
                        return;

                    })
                    .ajaxComplete(function () {
                        if (noLista) {
                            $.blockUI({
                                message: '<h1><img src="' + loading + '" />Espere...</h1>',
                                css: {
                                    border: 'none',
                                    padding: '15px',
                                    backgroundColor: '#000',
                                    '-webkit-border-radius': '10px',
                                    '-moz-border-radius': '10px',
                                    opacity: .5,
                                    color: '#fff'
                                }
                            });
                            setTimeout(function () {
                                $.unblockUI({
                                    onUnblock: function () {
                                        $("#cuerpoMensaje").html(mensajesFuncion);
                                        $("#btnMensaje").click();
                                    }
                                });
                            }, 3000);
                        }
                        else {
                            $.blockUI({
                                message: '<h1><img src="' + loading + '" />Cargando infomación...</h1>',
                                css: {
                                    border: 'none',
                                    padding: '15px',
                                    backgroundColor: '#000',
                                    '-webkit-border-radius': '10px',
                                    '-moz-border-radius': '10px',
                                    opacity: .5,
                                    color: '#fff'
                                }
                            });
                            setTimeout(function () {
                                if (_desbloquea) {
                                    $.unblockUI({
                                        onUnblock: Desbloquear(mensajesFuncion, noLista, boton)
                                    });
                                    _desbloquea = false;
                                }
                                else {
                                    $.unblockUI
                                }
                            }, 10000);
                        }
                    })
                    .ajaxStop($.unblockUI);
                $.ajax({
                    type: "post",
                    url: url_dir + '/Administracion/NotasCargo',
                    data: { 'fecha1': fecha1, 'fecha2': fecha2, 'numProveedor': numProv, 'sociedad': sociedad, 'tipoDocumento': tipoDoc, 'paquete': paquete, 'todos': todos },
                    cache: false,
                    success: function (lista) {
                        _desbloquea = true;

                        if (typeof (lista) == "string") {
                            noLista = true;
                        }
                        else {
                            noLista = false;
                        }
                        mensajesFuncion = lista;
                    },
                    error: function (xhr, status, p3, p4) {
                        var err = xhr.responseText + " Status" + xrhr.status;
                        $("#cuerpoMensaje").html("Ocurrió un error: " + err);
                    }
                });
            }
            function MostrarTablaProveedores(numPro, fecha) {
                $("#mensajes").html("");
                $(document).ajaxStart(
                    $.blockUI({
                        message: '<h1><img src="' + loading + '" /> Espere...</h1>',
                        css: {
                            border: 'none',
                            padding: '15px',
                            backgroundColor: '#000',
                            '-webkit-border-radius': '10px',
                            '-moz-border-radius': '10px',
                            opacity: .5,
                            color: '#fff'
                        }
                    }))
                    .ajaxSend($.blockUI({
                        message: '<h1><img src="' + loading + '" /> Consultando...</h1>',
                        css: {
                            border: 'none',
                            padding: '15px',
                            backgroundColor: '#000',
                            '-webkit-border-radius': '10px',
                            '-moz-border-radius': '10px',
                            opacity: .5,
                            color: '#fff'
                        }
                    }))
                    .ajaxSuccess($.blockUI({
                        message: '<h1><img src="' + loading + '" /> Consultando información...</h1>',
                        css: {
                            border: 'none',
                            padding: '15px',
                            backgroundColor: '#000',
                            '-webkit-border-radius': '10px',
                            '-moz-border-radius': '10px',
                            opacity: .5,
                            color: '#fff'
                        }
                    }))
                    .ajaxError(function (xhr, status, p3, p4) {
                        $.blockUI({
                            message: '<h1><img src="' + loading + '" />Espere...</h1>',
                            css: {
                                border: 'none',
                                padding: '15px',
                                backgroundColor: '#000',
                                '-webkit-border-radius': '10px',
                                '-moz-border-radius': '10px',
                                opacity: .5,
                                color: '#fff'
                            }
                        });
                        setTimeout(function () {
                            $.unblockUI();
                        }, 2000);
                        return;

                    })
                    .ajaxComplete(function () {
                        $.blockUI({
                            message: '<h1><img src="' + loading + '" />Espere...</h1>',
                            css: {
                                border: 'none',
                                padding: '15px',
                                backgroundColor: '#000',
                                '-webkit-border-radius': '10px',
                                '-moz-border-radius': '10px',
                                opacity: .5,
                                color: '#fff'
                            }
                        });
                        setTimeout(function () {
                            $.unblockUI();
                        }, 3000);

                    })
                    .ajaxStop($.unblockUI);
                $.ajax({
                    type: "post",
                    url: url_dir + '/Administracion/ConsultaProveedores',
                    data: { "numProveedor": numPro, "fechaInicial": fecha },
                    cache: false,
                    success: function (obj) {
                        try{
                            if (obj != 'Object reference not set to an instance of an object.')
                            {
                                if (obj.lista.length > 0) {
                                    var columnas =
                                        "<th>Num Proveedor</th>" +
                                        "<th>País</th>" +
                                        "<th>Nombre Proveedor</th>" +
                                        "<th>Población</th>" +
                                        "<th>Dirección</th>" +
                                        //"<th>Preregistrado</th>" +
                                        "<th>RFC</th>" +
                                        "<th>Completar registro</th>";
                                    var contenido = "";
                                    for (var i = 0; i < obj.lista.length; i++) {
                                        var _nombre = obj.lista[i].R3;
                                        contenido +=
                                            "<tr>" +
                                                "<td>" + obj.lista[i].R1 + "</td>" +
                                                "<td>" + obj.lista[i].R2 + "</td>" +
                                                "<td>" + obj.lista[i].R3 + "</td>" +
                                                "<td>" + obj.lista[i].R4 + "</td>" +
                                                "<td>" + obj.lista[i].R5 + "</td>" +
                                                //"<td>" + obj.lista[i].R6 + "</td>" +
                                                "<td>" +
                                                              obj.lista[i].R7
                                                + "</td>" +
                                                //"<td>" + obj.lista[i].R8 + "</td>" +
                                                "<td>" + '<button type="button" class="btn btn-primary" id="btnCompletarRegistroProv" name="btnTablaProv" data-toggle="modal" title="Complementar datos del proveedor" data-target="#modCompletarRegistroProv" onclick="pasaProveedorSeleccionado(' + "'" + _nombre + "'" + "," + obj.lista[i].R9 + ')" ><i class="fa fa-table"></i>Completar registro</button>' + "</td>" +
                                            "</tr>";
                                    }
                                    var tabla = '<table id="Tabla_" class="table table-striped table-bordered" cellspacing="0" width="100%">' +
                                                                                    '<thead>' +
                                                                                       '<tr>' + columnas + '</tr>' +
                                                                                    '</thead>' +
                                                                                    '<tbody>' + contenido + '</tbody>' +
                                                                                '</table>';
                                    $(".table-responsive").html(tabla);
                                    $('#Tabla_').dataTable();


                                }
                                else
                                {
                                    if (obj.mensaje.substring(0, 1) == "E") {
                                        $("#cuerpoMensaje").html("Ocurrió un error: " + obj.mensaje.substring(2));
                                        $("#btnMensaje").click();
                                    }
                                    $(".table-responsive").html("No se encontraron registros.");
                                }
                            }
                            else
                            {
                                $("#cuerpoMensaje").html("Ocurrió un error localizando el proveedor: " + obj);
                                $("#btnMensaje").click();
                                showErrorMessage('El valor capturado quizás no es válido, debe ser el No. de Proveedor únicamente!');
                            }
                        }
                        catch(err)
                        {
                            $("#cuerpoMensaje").html("Ocurrió un error localizando el proveedor: " + err);
                            $("#btnMensaje").click();
                            showErrorMessage('El valor capturado quizás no es válido, debe ser el No. de Proveedor únicamente!');
                        }
                    },
                    error: function (error) {
                        $("#cuerpoMensaje").html("Ocurrió un error: " + error);
                        $("#btnMensaje").click();
                    }
                });

                $("#Tablas").animate({
                    top: "+=50",
                    height: "toggle"
                });
            }
            function MostrarTablaSociedades(sociedad) {
                $("#mensajes").html("");
                $(document).ajaxStart(
                    $.blockUI({
                        message: '<h1><img src="' + loading + '" /> Espere...</h1>',
                        css: {
                            border: 'none',
                            padding: '15px',
                            backgroundColor: '#000',
                            '-webkit-border-radius': '10px',
                            '-moz-border-radius': '10px',
                            opacity: .5,
                            color: '#fff'
                        }
                    }))
                    .ajaxSend($.blockUI({
                        message: '<h1><img src="' + loading + '" /> Consultando...</h1>',
                        css: {
                            border: 'none',
                            padding: '15px',
                            backgroundColor: '#000',
                            '-webkit-border-radius': '10px',
                            '-moz-border-radius': '10px',
                            opacity: .5,
                            color: '#fff'
                        }
                    }))
                    .ajaxSuccess($.blockUI({
                        message: '<h1><img src="' + loading + '" /> Consultando información...</h1>',
                        css: {
                            border: 'none',
                            padding: '15px',
                            backgroundColor: '#000',
                            '-webkit-border-radius': '10px',
                            '-moz-border-radius': '10px',
                            opacity: .5,
                            color: '#fff'
                        }
                    }))
                    .ajaxError(function (xhr, status, p3, p4) {
                        $.blockUI({
                            message: '<h1><img src="' + loading + '" />Espere...</h1>',
                            css: {
                                border: 'none',
                                padding: '15px',
                                backgroundColor: '#000',
                                '-webkit-border-radius': '10px',
                                '-moz-border-radius': '10px',
                                opacity: .5,
                                color: '#fff'
                            }
                        });
                        setTimeout(function () {
                            $.unblockUI();
                        }, 2000);
                        return;

                    })
                    .ajaxComplete(function () {
                        $.blockUI({
                            message: '<h1><img src="' + loading + '" />Espere...</h1>',
                            css: {
                                border: 'none',
                                padding: '15px',
                                backgroundColor: '#000',
                                '-webkit-border-radius': '10px',
                                '-moz-border-radius': '10px',
                                opacity: .5,
                                color: '#fff'
                            }
                        });
                        setTimeout(function () {
                            $.unblockUI();
                        }, 3000);

                    })
                    .ajaxStop($.unblockUI);
                $.ajax({
                    type: "post",
                    url: url_dir + '/Administracion/ConsultaSociedades',
                    data: { 'sociedad': sociedad },
                    cache: false,
                    success: function (lista) {
                        if (lista.length > 0) {
                            var columnas =
                                "<th>Num sociedad</th>" +
                                "<th>Compania</th>" +
                                "<th>Poblacion</th>" +
                                "<th>Pais</th>" +
                                "<th>Moneda</th>" +
                                "<th>Direccion</th>" +
                                "<th>RFC</th>";
                            var contenido = "";
                            for (var i = 0; i < lista.length; i++) {
                                contenido +=
                                    "<tr>" +
                                        "<td>" + lista[i].R1 + "</td>" +
                                        "<td>" + lista[i].R2 + "</td>" +
                                        "<td>" + lista[i].R3 + "</td>" +
                                        "<td>" + lista[i].R4 + "</td>" +
                                        "<td>" + lista[i].R5 + "</td>" +
                                        "<td>" + lista[i].R6 + "</td>" +
                                        "<td>" + lista[i].R7 + "</td>" +
                                    "</tr>";
                            }
                            var tabla = '<table id="Tabla_" class="table table-striped table-bordered" cellspacing="0" width="100%">' +
                                            '<thead>' +
                                               '<tr>' + columnas + '</tr>' +
                                            '</thead>' +
                                            '<tbody>' + contenido + '</tbody>' +
                                        '</table>';
                            $(".table-responsive").html(tabla);
                            $('#Tabla_').dataTable();
                        }
                        else {
                            $(".table-responsive").html("No se encontraron registros.");
                        }
                    },
                    error: function (error) {
                        $("#cuerpoMensaje").html("Ocurrió un error: " + error);
                        $("#btnMensaje").click();
                    }
                });
                $("#Tablas").animate({
                    top: "+=50",
                    height: "toggle"
                });
            }
            function MostrarTablaOrdenCompra(fecha1, fecha2, numProv, sociedad, ordenCompra, ticket) {
                $("#mensajes").html("");
                $(document).ajaxStart(
                    $.blockUI({
                        message: '<h1><img src="' + loading + '" /> Espere...</h1>',
                        css: {
                            border: 'none',
                            padding: '15px',
                            backgroundColor: '#000',
                            '-webkit-border-radius': '10px',
                            '-moz-border-radius': '10px',
                            opacity: .5,
                            color: '#fff'
                        }
                    }))
                    .ajaxSend($.blockUI({
                        message: '<h1><img src="' + loading + '" /> Consultando...</h1>',
                        css: {
                            border: 'none',
                            padding: '15px',
                            backgroundColor: '#000',
                            '-webkit-border-radius': '10px',
                            '-moz-border-radius': '10px',
                            opacity: .5,
                            color: '#fff'
                        }
                    }))
                    .ajaxSuccess($.blockUI({
                        message: '<h1><img src="' + loading + '" /> Consultando información...</h1>',
                        css: {
                            border: 'none',
                            padding: '15px',
                            backgroundColor: '#000',
                            '-webkit-border-radius': '10px',
                            '-moz-border-radius': '10px',
                            opacity: .5,
                            color: '#fff'
                        }
                    }))
                    .ajaxError(function (xhr, status, p3, p4) {
                        $.blockUI({
                            message: '<h1><img src="' + loading + '" />Espere...</h1>',
                            css: {
                                border: 'none',
                                padding: '15px',
                                backgroundColor: '#000',
                                '-webkit-border-radius': '10px',
                                '-moz-border-radius': '10px',
                                opacity: .5,
                                color: '#fff'
                            }
                        });
                        setTimeout(function () {
                            $.unblockUI();
                        }, 2000);
                        return;

                    })
                    .ajaxComplete(function () {
                        $.blockUI({
                            message: '<h1><img src="' + loading + '" />Espere...</h1>',
                            css: {
                                border: 'none',
                                padding: '15px',
                                backgroundColor: '#000',
                                '-webkit-border-radius': '10px',
                                '-moz-border-radius': '10px',
                                opacity: .5,
                                color: '#fff'
                            }
                        });
                        setTimeout(function () {
                            $.unblockUI();
                        }, 3000);

                    })
                    .ajaxStop($.unblockUI);
                $.ajax({
                    type: "get",
                    url: url_dir + '/Administracion/ConsultaOrdenesCompra',
                    data: { 'fecha1': fecha1, 'fecha2': fecha2, 'numProveedor': numProv, 'sociedad': sociedad, 'ordencompra': ordenCompra, 'ticket': ticket },
                    cache: false,
                    success: function (obj) {
                        if (obj.lista != undefined && obj.lista.length > 0) {
                            var columnas =
                                "<th>Orden de Compra</th>" +
                                "<th>Sociedad</th>" +
                                "<th>Tipo de Documento</th>" +
                                "<th>Clase Documento</th>" +
                                "<th>Borrado</th>" +
                                "<th>Fecha Creación</th>" +
                                "<th>Num. Proveedor</th>" +
                                "<th>Condiciones de Pago</th>" +
                                "<th>Organización Compra</th>" +
                                "<th>Grupo Compras</th>" +
                                "<th>Condición Documento</th>" +
                                "<th>Moneda</th>" +
                                "<th>Tipo de Cambio</th>" +
                                "<th>Monto</th>" +
                                "<th>No. Documento</th>";
                            var contenido = "";
                            for (var i = 0; i < obj.lista.length; i++) {
                                contenido +=
                                    "<tr>" +
                                        "<td>" + obj.lista[i].R1 + "</td>" +
                                        "<td>" + obj.lista[i].R2 + "</td>" +
                                        "<td>" + obj.lista[i].R3 + "</td>" +
                                        "<td>" + obj.lista[i].R4 + "</td>" +
                                        "<td>" + obj.lista[i].R5 + "</td>" +
                                        "<td>" + obj.lista[i].R6 + "</td>" +
                                        "<td>" + obj.lista[i].R7 + "</td>" +
                                        "<td>" + obj.lista[i].R8 + "</td>" +
                                        "<td>" + obj.lista[i].R9 + "</td>" +
                                        "<td>" + obj.lista[i].R10 + "</td>" +
                                        "<td>" + obj.lista[i].R11 + "</td>" +
                                        "<td>" + obj.lista[i].R12 + "</td>" +
                                        "<td>" + obj.lista[i].R13 + "</td>" +
                                        "<td>" + obj.lista[i].R14 + "</td>" +
                                        "<td>" + obj.lista[i].R15 + "</td>" +
                                    "</tr>";
                            }
                            var tabla = '<table id="Tabla_" class="table table-striped table-bordered" cellspacing="0" width="100%">' +
                                                                            '<thead>' +
                                                                               '<tr>' + columnas + '</tr>' +
                                                                            '</thead>' +
                                                                            '<tbody>' + contenido + '</tbody>' +
                                                                        '</table>';
                            $(".table-responsive").html(tabla);
                            $('#Tabla_').dataTable();
                        }
                        else {
                            $(".table-responsive").html("No se encontraron registros.");
                        }
                    },
                    error: function (error) {
                        $("#cuerpoMensaje").html("Ocurrió un error: " + error);
                        $("#btnMensaje").click();
                    }

                });
                $("#Tablas").animate({
                    top: "+=50",
                    height: "toggle"
                });
            }
            function MostrarTablaNotasCargo(fecha1, fecha2, numProv, sociedad, tipoDoc, paquete, todos) {
                $("#mensajes").html("");
                $(document).ajaxStart(
                    $.blockUI({
                        message: '<h1><img src="' + loading + '" /> Espere...</h1>',
                        css: {
                            border: 'none',
                            padding: '15px',
                            backgroundColor: '#000',
                            '-webkit-border-radius': '10px',
                            '-moz-border-radius': '10px',
                            opacity: .5,
                            color: '#fff'
                        }
                    }))
                    .ajaxSend($.blockUI({
                        message: '<h1><img src="' + loading + '" /> Consultando...</h1>',
                        css: {
                            border: 'none',
                            padding: '15px',
                            backgroundColor: '#000',
                            '-webkit-border-radius': '10px',
                            '-moz-border-radius': '10px',
                            opacity: .5,
                            color: '#fff'
                        }
                    }))
                    .ajaxSuccess($.blockUI({
                        message: '<h1><img src="' + loading + '" /> Consultando información...</h1>',
                        css: {
                            border: 'none',
                            padding: '15px',
                            backgroundColor: '#000',
                            '-webkit-border-radius': '10px',
                            '-moz-border-radius': '10px',
                            opacity: .5,
                            color: '#fff'
                        }
                    }))
                    .ajaxError(function (xhr, status, p3, p4) {
                        $.blockUI({
                            message: '<h1><img src="' + loading + '" />Espere...</h1>',
                            css: {
                                border: 'none',
                                padding: '15px',
                                backgroundColor: '#000',
                                '-webkit-border-radius': '10px',
                                '-moz-border-radius': '10px',
                                opacity: .5,
                                color: '#fff'
                            }
                        });
                        setTimeout(function () {
                            $.unblockUI();
                        }, 2000);
                        return;

                    })
                    .ajaxComplete(function () {
                        $.blockUI({
                            message: '<h1><img src="' + loading + '" />Espere...</h1>',
                            css: {
                                border: 'none',
                                padding: '15px',
                                backgroundColor: '#000',
                                '-webkit-border-radius': '10px',
                                '-moz-border-radius': '10px',
                                opacity: .5,
                                color: '#fff'
                            }
                        });
                        setTimeout(function () {
                            $.unblockUI();
                        }, 3000);

                    })
                    .ajaxStop($.unblockUI);
                $.ajax({
                    type: "get",
                    url: url_dir + '/Administracion/ConsultaNotasCargo',
                    data: { 'fecha1': fecha1, 'fecha2': fecha2, 'numProveedor': numProv, 'sociedad': sociedad, 'tipoDocumento': tipoDoc, 'paquete': paquete, 'todos': todos },
                    cache: false,
                    success: function (lista) {
                        if (typeof(lista) == "string") {
                            $("#cuerpoMensaje").html(lista);
                            $("#btnMensaje").click();
                        }
                        else {
                            if (lista.length > 0) {
                                var columnas =
                                    "<th>Sociedad</th>" +
                                    "<th>Proveedor</th>" +
                                    "<th>Fecha Compensación</th>" +
                                    "<th>Documento Compensación</th>" +
                                    "<th>Número Asignación</th>" +
                                    "<th>Año Ejercicio</th>" +
                                    "<th>Documento Contable</th>" +
                                    "<th>Fecha Contable</th>" +
                                    "<th>Fecha Documento</th>" +
                                    "<th>Documento Referencia</th>" +
                                    "<th>Tipo Documento</th>" +
                                    "<th>Mes Contable</th>" +
                                    "<th>Archivo XML</th>" +
                                    "<th>Estatus Compensación</th>";
                                var contenido = "";
                                for (var i = 0; i < lista.length; i++) {
                                    contenido +=
                                        "<tr>" +
                                            "<td>" + lista[i].R1 + "</td>" +
                                            "<td>" + lista[i].R2 + "</td>" +
                                            "<td>" + lista[i].R3 + "</td>" +
                                            "<td>" + lista[i].R4 + "</td>" +
                                            "<td>" + lista[i].R5 + "</td>" +
                                            "<td>" + lista[i].R6 + "</td>" +
                                            "<td>" + lista[i].R7 + "</td>" +
                                            "<td>" + lista[i].R8 + "</td>" +
                                            "<td>" + lista[i].R9 + "</td>" +
                                            "<td>" + lista[i].R10 + "</td>" +
                                            "<td>" + lista[i].R11 + "</td>" +
                                            "<td>" + lista[i].R12 + "</td>" +
                                            "<td>" + lista[i].R13 + "</td>" +
                                            "<td>" + lista[i].R14 + "</td>" +
                                        "</tr>";
                                }
                                var tabla = '<table id="Tabla_" class="table table-striped table-bordered" cellspacing="0" width="100%">' +
                                                                                '<thead>' +
                                                                                   '<tr>' + columnas + '</tr>' +
                                                                                '</thead>' +
                                                                                '<tbody>' + contenido + '</tbody>' +
                                                                            '</table>';
                                $(".table-responsive").html(tabla);
                                $('#Tabla_').dataTable();
                            }
                            else {
                                $(".table-responsive").html("No se encontraron registros.");
                            }
                        }
                    },
                    error: function (error) {
                        $("#cuerpoMensaje").html("Ocurrió un error: " + error);
                        $("#btnMensaje").click();
                    }

                });
                $("#Tablas").animate({
                    top: "+=50",
                    height: "toggle"
                });
            }
            function Desbloquear(mensajesFuncion, noLista, boton) {
                var mensajeFinal;
                $("#mensajes").html("");
                for (var i = 0; i < mensajesFuncion.length; i++) {
                    var msg = mensajesFuncion[i].split('|');
                    if (msg.length == 1) {
                        if (msg[0] == "True" || msg[0] == "true") {
                            //$(boton).removeClass("btn btn-primary").addClass("btn btn-success");
                            $("#cuerpoMensaje").html("La carga de los datos se ha realizado correctamente.");
                            $("#btnMensaje").click();
                            mensajeFinal = "Finalizado";
                            $(boton).css("display", "none");
                            msg[0] = "";
                            return;
                        }
                        else if (msg[0] == "False" || msg[0] == "false") {
                            $(boton).removeClass("btn btn-primary").addClass("btn btn-danger");
                            mensajeFinal = "No se completo la operación.";
                            msg[0] = "";
                            $(boton).css("display", "inline-block");
                        }
                        if (msg[0] != "") {
                            var tipoError = msg[0].substring(0, 6);
                            if (tipoError.includes("Error") == false)
                            {
                             var elemento1 = '<div class="alert alert-success alert-dismissable">' +
                             '<table style="width: 100%;">' +
                             '<tbody>' +
                             '<tr><td style="width: 30px; max-width: 30px;"><div>' +
                             '<img class="img-circle" src= "' + url_dir + '/Images/bafar/iconProcedio.png" />' +
                             '</div></td><td>' +
                             '<div style="padding-left: 10px; text-align: justify;">' + msg[0] + '</div>' +
                             '</td></tr>' +
                             '</tbody>' +
                             '</div>';
                             $("#mensajes").append(elemento1);
                            }
                            else
                            {
                             var elemento2 = '<div class="alert alert-danger alert-dismissable">' +
                             '<table style="width: 100%;">' +
                             '<tbody>' +
                             '<tr><td style="width: 30px; max-width: 30px;"><div>' +
                             '<img class="img-circle" src= "' + url_dir + '/Images/bafar/iconNoProcedio.png" />' +
                             '</div></td><td>' +
                             '<div style="padding-left: 10px; text-align: justify;">' + msg[0] + '</div>' +
                             '</td></tr>' +
                             '</tbody>' +
                             '</div>';
                             $("#mensajes").append(elemento2);
                            }
                        }
                    }
                    else if (msg.length == 2 && msg[0] == "E") {
                        var elemento2 = '<div class="alert alert-danger alert-dismissable">' +
                            '<table style="width: 100%;">' +
                            '<tbody>' +
                            '<tr><td style="width: 30px; max-width: 30px;"><div>' +
                            '<img class="img-circle" src="' + url_dir + '/Images/bafar/iconNoProcedio.png" />' +
                            '</div></td><td>' +
                            '<div style="padding-left: 10px; text-align: justify;">' + msg[1] + '</div>' +
                            '</td></tr>' +
                            '</tbody>' +
                            '</div>';
                        $("#mensajes").append(elemento2);
                    }
                }
                var color;
                var icono;
                if (mensajeFinal == "Finalizado") {
                    color = "alert-success";
                    icono = "iconProcedio";
                }
                else {
                    color = "alert-danger";
                    icono = "iconNoProcedio";
                }
                var final = '<div class="alert ' + color + ' alert-dismissable">' +
                            '<table style="width: 100%;">' +
                            '<tbody>' +
                            '<tr><td style="width: 30px; max-width: 30px;"><div>' +
                            '<img class="img-circle" src="' + url_dir + '/Images/bafar/' + icono + '.png" />' +
                            '</div></td><td>' +
                            '<div style="padding-left: 10px; text-align: justify;">' + mensajeFinal + '</div>' +
                            '</td></tr>' +
                            '</tbody>' +
                            '</div>';
                $("#mensajes").append(final);
                var tmp;
            }

            function completarRegistroProveedor(rfc,correo,correoSAP,numproveedor)
            {
               if (rfc.length>0)
               {
                    $.ajax({
                     type: "post",
                     url: url_dir + '/Administracion/guardarCompletarRegistroProveedor',
                     data: { 'rfc': rfc,'correo' : correo, 'correoSAP' : correoSAP, 'numproveedor': numproveedor},
                     cache: false,
                     success: function (lista) {
                      if (lista.mensaje.length > 0) {
                          //se realizo con éxito
                          var exitosa = false;
                          var razones = '';
                          for (var i = 0; i < lista.mensaje.length; i++) {
                              var m = lista.mensaje[i];
                              if (m.includes('se realizo con éxito') == true)
                                  exitosa = true;
                              else
                                  showErrorMessage(m);
                              razones=razones+ m +' ';
                          }
                          if(exitosa==true)
                          {
                              showSuccess('Información actualizada!');
                              $("#btnCerrar").click();
                          }
                          else
                          {
                              $("#btnCerrar").click();
                              $("#cuerpoMensaje").html("Ocurrió un error guardando : " + razones);
                              $("#btnMensaje").click();
                          }
                      }
                      else {
                                 $("#btnCerrar").click();
                                 $(".table-responsive").html("No se almaceno la información.");
                           }
                     },
                     error: function (error) {
                      $("#btnCerrar").click();
                      $("#cuerpoMensaje").html("Ocurrió un error guardando : " + error);
                      $("#btnMensaje").click();
                     }
                    });
               }
               else
               {

               }
            }




        });


        $("#btnimportaSociedad").click(function (e) {
         var miSoc = $("#miSociedad").val();
         traeTodo(miSoc);
        });
    });

    function cargaRegistroProveedor(numproveedor,idproveedor) {
     if (rfc.length > 0) {
      $.ajax({
       type: "post",
       url: url_dir + '/Administracion/guardarCompletarRegistroProveedor',
       data: { 'idproveedor': idproveedor, 'numproveedor': numproveedor },
       cache: false,
       success: function (lista) {
        if (lista.length > 0) {
            
        }
        else {
         $(".table-responsive").html("No se almaceno la información.");
        }
       },
       error: function (error) {
        $("#cuerpoMensaje").html("Ocurrió un error guardando : " + error);
        $("#btnMensaje").click();
       }
      });
     }
     else {

     }
    }


  function configuraAgregarUsuario()
    {
     $("#listadoUsuariosxProveedor").hide();

        $("#listadoTodosPerfiles").show();

        $("#btnIdUsuario").html('-1');

        $('#nombreUsuario').text('');
        $('#nombreUsuario').val('');

        $('#passwordusuario').text('');
        $('#passwordUsuario').val('');

        $('#correoUsuario').text('');
        $('#correoUsuario').val('');
   
  }

  function configuraEditarUsuario() {


   $("#listadoUsuariosxProveedor").show();

   $("#listadoTodosPerfiles").show();

   $("#btnIdUsuario").html('-1');

   $('#nombreUsuario').text('');
   $('#nombreUsuario').val('');

   $('#passwordusuario').text('');
   $('#passwordUsuario').val('');

   $('#correoUsuario').text('');
   $('#correoUsuario').val('');

   cargaUsuarios('carga');

  }

    function pasaProveedorSeleccionado(nombreProveedor,idProveedor)
           {
               $('#NombreProveedor').text(nombreProveedor);
               $('#IdProveedor').text(idProveedor);
               cargaUsuarios($('#misUsuarios'));
               $.ajax({
                   type: "post",
                   url: url_dir + '/Administracion/cargaComplementoProveedores',
                   data: { "idProveedor": idProveedor },
                   cache: false,
                   success: function (_obj) {
                       try {
                           if (_obj != 'Object reference not set to an instance of an object.') 
                               if (_obj.length > 0)
                               {
                                   //Carga informacion RFC, Correo Coorporativo y Correo SAP
                                   var _rfc = _obj[0]; //RFC
                                   var _correocoorporativa = _obj[1]; //Correo Coorporativo
                                   var _correosap = _obj[2]; //Correo SAP
                                   $('#_RFC').text(_rfc);
                                   $('#_RFC').val(_rfc);
                                   $('#_Correo').text(_correocoorporativa);
                                   $('#_Correo').val(_correocoorporativa);
                                   $('#_Correo2').text(_correosap);
                                   $('#_Correo2').val(_correosap);
                               }
                           }
                        catch (_err) 
                           {
                                   $("#cuerpoMensaje").html("Ocurrió un error recuperando información : " + _err);
                                   $("#btnMensaje").click();
                           }
                   },
                   error: function (error) {
                       $("#cuerpoMensaje").html("Ocurrió un error guardando el Perfíl : " + error);
                       $("#btnMensaje").click();
                   }
               });

    }

    function guardaComplementos()
    {
        var idProveedor = $('#IdProveedor').text();
        var _rfc = $('#_RFC').text(); //RFC
        var _correocoorporativa = $('#_Correo').text(); //Correo Coorporativo
        var _correosap = $('#_Correo2').text(); //Correo SAP
        $.ajax({
            type: "post",
            url: url_dir + '/Administracion/enviaComplementoProveedores',
            data: { "idProveedor": idProveedor,"RFC":_rfc,"correoCoorporativo":_correocoorporativo,"correoSAP":_correosap },
            cache: false,
            success: function (_obj) {
                //Se almaceno!
            }
            ,
            error: function (error) {
                $("#cuerpoMensaje").html("Ocurrió un error guardando el Perfíl : " + error);
                $("#btnMensaje").click();
            }
        });


    }

    function traeTodo(miSoc) {
     if (miSoc.length > 0) {
      $(document).ajaxStart(
        $.blockUI({
         message: '<h1><img src="' + loading + '" /> Iniciando carga masiva...</h1>',
         css: {
          border: 'none',
          padding: '15px',
          backgroundColor: '#000',
          '-webkit-border-radius': '10px',
          '-moz-border-radius': '10px',
          opacity: .5,
          color: '#fff'
         }
        }))
        .ajaxSend(
            $.blockUI({
             message: '<h1><img src="' + loading + '" /> Iniciando carga masiva...</h1>',
             css: {
              border: 'none',
              padding: '15px',
              backgroundColor: '#000',
              '-webkit-border-radius': '10px',
              '-moz-border-radius': '10px',
              opacity: .5,
              color: '#fff'
             }
            }))
        .ajaxError($.unblockUI)
        .ajaxComplete($.unblockUI)
        .ajaxStop($.unblockUI);
      //Enviar por  Perfiles
      $.ajax({
       type: "post",
       url: url_dir + '/Administracion/importaSociedad',
       data: { 'miSoc': miSoc},
       cache: false,
       success: function (listaProveedores) {
        if (listaProveedores.length > 0) {
              //Ejecuto con exito
         var paso;
         var mensajesAcumulados = '';
         var cadena = '';
         for (paso = 0; paso < listaProveedores.length; paso++) {
          cadena = listaProveedores[paso];
          if (cadena.indexOf('Inicio') > -1) {
                 showSuccess(listaProveedores[paso]);
                 mensajesAcumulados = mensajesAcumulados + listaProveedores[paso] + ' <> ';
                }
          if (cadena.indexOf('Actualización')>-1)
                {
                 showSuccess(listaProveedores[paso]);
                 mensajesAcumulados = mensajesAcumulados + listaProveedores[paso] + ' <> ';
                }
          if (cadena.indexOf( 'Importado')>-1)
                {
                 showSuccess(listaProveedores[paso]);
                 mensajesAcumulados = mensajesAcumulados + listaProveedores[paso] + ' <> ';
                }
          if (cadena.indexOf( 'Error')>-1)
                {
                 showErrorMessage(listaProveedores[paso]);
                 mensajesAcumulados = mensajesAcumulados + listaProveedores[paso] + ' <> ';
          }
          if (cadena.indexOf('Z_PFI_GETVENDOR') > -1 || cadena.indexOf('ZMF_CFS_PROVEEDOR_PP') > -1) {
              showErrorMessage(listaProveedores[paso]);
              mensajesAcumulados = mensajesAcumulados + listaProveedores[paso] + ' <> ';
          }
                console.log(listaProveedores[paso]);
                $(".table-responsive").html("Resultados" + mensajesAcumulados);
               };
        }
        else {
         //Hubo problemas

         $(".table-responsive").html("Ocurrío un problema recuperando la información relacionada a los Perfiles asignados.");
        }
       },
       error: function (error) {
        $("#cuerpoMensaje").html("Ocurrió un error guardando el Perfíl : " + error);
        $("#btnMensaje").click();
       }
      });
     }
    }

        function obtenPerfiles()
        {
         //ddpperfilAsignado
         var numproveedor = $('#IdProveedor').text();
         var idUsuario = 'Todos';
         //if ($('#misUsuarios option:selected').val()!=null)
         //       idUsuario = $('#misUsuarios option:selected').val();
         if ($('#ddpperfilAsignado').length <= 1)
         {
          $(document).ajaxStart(
            $.blockUI({
             message: '<h1><img src="' + loading + '" /> Recuperando usuarios...</h1>',
             css: {
              border: 'none',
              padding: '15px',
              backgroundColor: '#000',
              '-webkit-border-radius': '10px',
              '-moz-border-radius': '10px',
              opacity: .5,
              color: '#fff'
             }
            }))
            .ajaxSend(
                $.blockUI({
                 message: '<h1><img src="' + loading + '" /> Recuperando usuarios...</h1>',
                 css: {
                  border: 'none',
                  padding: '15px',
                  backgroundColor: '#000',
                  '-webkit-border-radius': '10px',
                  '-moz-border-radius': '10px',
                  opacity: .5,
                  color: '#fff'
                 }
                }))
            .ajaxError($.unblockUI)
            .ajaxComplete($.unblockUI)
            .ajaxStop($.unblockUI);
             //Enviar por  Perfiles
                  $.ajax({
                   type: "post",
                   url: url_dir + '/Administracion/ObtenPerfiles',
                   data: { 'deQuien': idUsuario, 'numproveedor': numproveedor },
                   cache: false,
                   success: function (listaPerfil) {
                    var optionsP = $("#ddpperfilAsignado");
                    optionsP.empty();
                    if (listaPerfil.length > 0) {
                            //for (var i = 0; i <listaPerfil.length; i++) {
                            // $("#ddpperfilAsignado").append("<li class='selected' value=" + listaPerfil[i].Key + ">" + listaPerfil[i].Value + "</li>");
                            //}
                            for (var i = 0; i < listaPerfil.length; i++) {
                                   optionsP.append($("<option />").val(listaPerfil[i].Key).text(listaPerfil[i].Value));
                            }
                    }
                    else {
                     $(".table-responsive").html("Ocurrío un problema recuperando la información relacionada a los Perfiles asignados.");
                    }
                   },
                   error: function (error) {
                    $("#cuerpoMensaje").html("Ocurrió un error guardando el Perfíl : " + error);
                    $("#btnMensaje").click();
                   }
                  });
         }
        }

        function cargaPerfiles() {
         var idproveedor = $('#IdProveedor').text();
         var idusuario = 'Todos';
         //if ($('#misUsuarios option:selected').val()!=null)
         //       idUsuario = $('#misUsuarios option:selected').val();
          if ($('#ddpperfilAsignado').length <= 1) {

          $.getJSON("/Administracion/cargaPerfiles", { idUsuario: idusuario, idProveedor: idproveedor })
             .done(function (data) {
              var options = $("#btnperfilAsignado");
              options.empty();
              for (var i = 0; i < data.length; i++) {
               options.append($("<option />").val(data[i].Key).text(data[i].Value));
              }
             });

         }

        }

        function doSelection() {
         //alert($('#ddpperfilAsignado li.selected').attr('data-input'));
         var _selText = $('#btnperfilAsignado option:selected').val();
         //alert("Its displaying Entire List" + selText);
         return  _selText;
        }

        function doSelectionUsuarios() {
         //alert($('#ddpperfilAsignado li.selected').attr('data-input'));
         var idproveedor = $('#IdProveedor').text();
         //var status = $('#listbox-taskStatus option:selected').attr('status');
         var selText = $('#misUsuarios option:selected').val();
         if (selText!='-1')
         {
                    $(document).ajaxStart(
                    $.blockUI({
                  message: '<h1><img src="' + loading + '" /> Buscando usuario...</h1>',
                  css: {
                  border: 'none',
                  padding: '15px',
                  backgroundColor: '#000',
                      '-webkit-border-radius': '10px',
                      '-moz-border-radius': '10px',
                  opacity: .5,
                  color: '#fff'
                 }
                 }))
                .ajaxSend(
                    $.blockUI({
              message: '<h1><img src="' + loading + '" /> Buscando usuario...</h1>',
              css: {
              border: 'none',
              padding: '15px',
              backgroundColor: '#000',
                      '-webkit-border-radius': '10px',
                      '-moz-border-radius': '10px',
              opacity: .5,
              color: '#fff'
             }
             }))
                .ajaxError($.unblockUI)
                .ajaxComplete($.unblockUI)
                .ajaxStop($.unblockUI);
         //Recargando usuario seleccionado
              $.ajax({
               type: "post",
               url: url_dir + '/Administracion/obtenUsuario',
               data: { 'idusuario': selText, 'idproveedor': idproveedor},
               cache: false,
               success: function (listaUsuarioRecuperado) {
                if (listaUsuarioRecuperado.length > 0) {
                       if (listaUsuarioRecuperado[0].Key != 'Error')
                       {
                        for (var i = 0; i < listaUsuarioRecuperado.length; i++) {
                         if (listaUsuarioRecuperado[i].Key == 'IdUsuario') {
                          $("#btnIdUsuario").html(listaUsuarioRecuperado[i].Value);
                         }
                          if (listaUsuarioRecuperado[i].Key=='Usuario') {
                           $('#nombreUsuario').text(listaUsuarioRecuperado[i].Value);
                           $('#nombreUsuario').val(listaUsuarioRecuperado[i].Value);
                          }
                          if (listaUsuarioRecuperado[i].Key == 'Password') {
                           $('#passwordusuario').text(listaUsuarioRecuperado[i].Value);
                           $('#passwordUsuario').val(listaUsuarioRecuperado[i].Value);
                          }
                          if (listaUsuarioRecuperado[i].Key == 'Correo') {
                           $('#correoUsuario').text(listaUsuarioRecuperado[i].Value);
                           $('#correoUsuario').val(listaUsuarioRecuperado[i].Value);
                          }
                          if (listaUsuarioRecuperado[i].Key == 'Perfil') {
                           $('#perfilUsuario').text(listaUsuarioRecuperado[i].Value);
                           $('#perfilUsuario').val(listaUsuarioRecuperado[i].Value);
                           //$('#btnperfilAsignado option[value=' + listaUsuarioRecuperado[i].Key + ']').attr('selected', true);
                          }
                          if (listaUsuarioRecuperado[i].Key == 'IdPerfil') {
                           //$('#perfilUsuario').text(listaUsuarioRecuperado[i].Value);
                           //$('#perfilUsuario').val(listaUsuarioRecuperado[i].Value);
                           $('#btnperfilAsignado option[value=' + listaUsuarioRecuperado[i].Value + ']').attr('selected', true);
                          }
                       }
                      }
                      else
                       {
                           $("#cuerpoMensaje").html("Ocurrió un error buscando al usuario " + error);
                           $("#btnMensaje").click();
                       }
                       cargaPerfiles();
                }
                else {
                 $(".table-responsive").html("Ocurrío un problema recuperando la información relacionada al usuario seleccionado, reintente por favor.");
                }
               },
               error: function (error) {
                $("#cuerpoMensaje").html("Ocurrió un error buscando al usuario " + error);
                $("#btnMensaje").click();
               }
              });
         }
         //return selText;
        }

        function cargaUsuarios(selecteditem) {
         var idproveedor = $('#IdProveedor').text();

         $.getJSON("/Administracion/cargaUsuarios", { idProveedor : idproveedor})
             .done(function (data) {
              var options = $("#misUsuarios");
              options.empty();
              for (var i = 0; i < data.length; i++) {
                   options.append($("<option />").val(data[i].Key).text(data[i].Value));
              }
             });
        }

    </script>
}
